##### üîê 7.3.1 Ex√©cuter en tant qu'administrateur

###### üîπ Pourquoi √©viter d'utiliser un compte administrateur ?
- Il est **d√©conseill√©** d'utiliser un compte avec **privil√®ges administrateur** pour se connecter √† Windows.
- **Risque** : Tout programme lanc√© h√©ritera des privil√®ges administratifs, y compris les **logiciels malveillants**.
- Un **malware** avec ces privil√®ges peut **acc√©der √† tous les fichiers et dossiers** de l'ordinateur.

###### üîπ Comment ex√©cuter un programme en tant qu‚Äôadministrateur ?
Lorsque l‚Äôinstallation ou l‚Äôex√©cution d‚Äôun logiciel **n√©cessite des privil√®ges administrateurs**, utilisez l‚Äôune des m√©thodes suivantes :
1. **Clic droit sur l‚Äôapplication** ‚ûù **"Ex√©cuter en tant qu‚Äôadministrateur"**.
2. **Utiliser l‚Äôinvite de commandes (cmd) avec √©l√©vation des privil√®ges** :
   - Ouvrir le menu D√©marrer.
   - Rechercher **"cmd"**.
   - Clic droit sur **"Invite de commandes"** ‚ûù **"Ex√©cuter en tant qu‚Äôadministrateur"**.
   - Taper la commande n√©cessaire et valider.

üõ† **Conseil : Toujours ex√©cuter un programme en tant qu'administrateur uniquement lorsque cela est strictement n√©cessaire !**

#### 7.3.2 Utilisateurs et Domaines Locaux :

###### üîπ Types de comptes utilisateurs sous Windows
Lors de l‚Äôinstallation de Windows ou du **premier d√©marrage**, un compte appel√© **"utilisateur local"** est cr√©√©.  
Il stocke les param√®tres de **personnalisation, permissions et emplacements de fichiers**.

Trois types de comptes existent :
1. **Utilisateur local** : Compte standard cr√©√© √† l‚Äôinstallation.
2. **Compte Administrateur** (‚ö†Ô∏è D√©sactiv√© par d√©faut) :
   - Poss√®de **tous les privil√®ges** sur le syst√®me.
   - **‚ö†Ô∏è Risque de s√©curit√©** : Ne pas l‚Äôactiver sauf n√©cessit√©.
3. **Compte Invit√©** (‚ö†Ô∏è D√©sactiv√© par d√©faut) :
   - Pas de mot de passe.
   - Environnement temporaire avec **privil√®ges limit√©s**.
   - ‚ö†Ô∏è **Ne pas activer** pour √©viter les failles de s√©curit√©.

###### üîπ Gestion des privil√®ges et s√©curit√©
- **√âviter d‚Äôaccorder les droits administrateurs aux comptes standards**.
- Si une t√¢che n√©cessite des droits admin :
  - Windows **demande le mot de passe administrateur** avant ex√©cution.
  - Emp√™che **l‚Äôinstallation ou l‚Äôex√©cution de logiciels non autoris√©s**.

###### üîπ Groupes d‚Äôutilisateurs sous Windows
Windows permet une gestion simplifi√©e via les **groupes** :
- Un **groupe** poss√®de un **nom** et un ensemble **d‚Äôautorisations sp√©cifiques**.
- **Avantages des groupes** :
  - Un utilisateur peut **appartenir √† plusieurs groupes** et **cumuler des permissions**.
  - Les autorisations **"refuser explicitement"** ont **priorit√©** sur celles accord√©es par d‚Äôautres groupes.
- **Exemple de groupe** :
  - **"Utilisateurs du journal de performances"** : peut programmer la collecte des journaux de performances.
- **Gestion des utilisateurs et groupes** via **lusrmgr.msc** (dans le panneau de configuration)

###### üîπ Qu'est-ce qu'un domaine Windows ?
Un **domaine** est un service r√©seau permettant de **g√©rer centralement** :
- **Utilisateurs**
- **Groupes**
- **Ordinateurs**
- **P√©riph√©riques**
- **Param√®tres de s√©curit√©**

Ces informations sont stock√©es dans une **base de donn√©es** contr√¥l√©e par un **contr√¥leur de domaine**.

###### üîπ R√¥le du contr√¥leur de domaine
Un **contr√¥leur de domaine** est un serveur sp√©cial qui :
1. **G√®re l‚Äôauthentification** des utilisateurs et des ordinateurs du r√©seau.
2. **Applique les politiques de s√©curit√©** pour chaque session utilisateur.
3. **Centralise la gestion des ressources** (acc√®s aux fichiers, imprimantes, etc.).

###### üîπ Fonctionnement de l'authentification
- Lorsqu'un **utilisateur ou un ordinateur** veut se connecter, il doit **s'authentifier aupr√®s du contr√¥leur de domaine**.
- Une fois connect√© :
  - Les **param√®tres de s√©curit√©** sont d√©finis **par le contr√¥leur**.
  - **Les autorisations correspondent par d√©faut** aux param√®tres locaux de l'ordinateur ou du compte utilisateur.

üìå **Avantage des domaines** :
‚úÖ **Gestion centralis√©e** des comptes et des permissions.  
‚úÖ **S√©curisation des acc√®s** et meilleure **tra√ßabilit√©**.  
‚úÖ **Facilit√© d'administration** pour les grandes entreprises et les r√©seaux complexes.

#### ‚ö° 7.3.3 CLI et PowerShell  

###### üîπ Interface de ligne de commande (CLI)  
- **Permet** d'ex√©cuter des programmes, de naviguer et de g√©rer fichiers/dossiers.  
- **Lancement** : Rechercher `cmd.exe`, possibilit√© d'ex√©cuter en **administrateur**.  
- **Fonctionnalit√©s cl√©s** :
  - Non sensible √† la casse pour les fichiers/chemins.  
  - Utilise **C:\dossier\fichier** pour structurer les fichiers.  
  - Historique des commandes via les **fl√®ches haut/bas**.  
  - Auto-compl√©tion avec la **touche Tab**.  

###### üîπ Windows PowerShell  
- **Plus puissant que la CLI** : permet **l'automatisation avanc√©e**.  
- **Lancement** : Rechercher **PowerShell**, ex√©cution possible en **administrateur**.  
- **Types de commandes** :
  - **Cmdlets** : Ex√©cutent des actions et retournent une sortie.  
  - **Scripts (.ps1)** : Contiennent plusieurs commandes √† ex√©cuter.  
  - **Fonctions** : Blocs de code r√©utilisables dans un script.  
- **Obtenir de l'aide** : Taper `help` dans PowerShell.  

üõ† **CLI = commandes basiques | PowerShell = automatisation avanc√©e !**

Il existe quatre niveaux d'aide dans le PowerShell Windows:

- **get-help**¬†_PS command_¬†- Affiche l'aide de base pour une commande
- **get-help**¬†_PS command [-examples]_¬†- Affiche l'aide de base pour une commande avec des exemples.
- **get-help**¬†_PS command [-detailed]_¬†- Affiche une aide d√©taill√©e pour une commande avec des exemples.
- **get-help**¬†_PS command [-full]_¬†- Affiche toutes les informations d'aide pour une commande avec des exemples plus d√©taill√©s.

#### 7.3.4 Instrumentation de gestion de Windows
##### ‚öôÔ∏è Windows Management Instrumentation (WMI)  

WMI est utilis√© pour **g√©rer les ordinateurs distants** en collectant des informations sur les composants mat√©riels et logiciels, tout en assurant l'int√©grit√© du syst√®me.  

###### üîπ Acc√®s au contr√¥le WMI  
1. Ouvrir **Panneau de configuration** > **Outils d'administration** > **Gestion de l'ordinateur**.  
2. D√©velopper **Services et Applications** > **Contr√¥le WMI** > **Propri√©t√©s**.  

üîç *La figure de gauche repr√©sente la fen√™tre Propri√©t√©s de: Contr√¥le WMI.*  
![[Pasted image 20250302175701.png]]
###### üõ†Ô∏è Onglets principaux  
- **G√©n√©ral** : Infos syst√®me et WMI.  
- **Sauvegarde/Restauration** : Sauvegarde manuelle des stats WMI.  
- **S√©curit√©** : Gestion des acc√®s aux donn√©es WMI.  
- **Avanc√©** : Configuration de l‚Äôespace de noms par d√©faut.  

###### ‚ö†Ô∏è S√©curit√© & Risques  
üî¥ WMI est exploit√© par des **attaques furtives** :  
- Utilis√© pour **modifier le Registre, ex√©cuter des commandes et contourner la d√©tection**.  
- Passe par un **trafic r√©seau approuv√©**, difficilement d√©tectable.  
- **Ne laisse pas de traces** sur l'h√¥te distant.  

üîê **Solution** : Restreindre **strictement** l‚Äôacc√®s √† l‚Äôinfrastructure WMI.  

![[Pasted image 20250302175706.png]]

#### 7.3.5 La commande du r√©seau

Windows permet d'ex√©cuter de nombreuses commandes via la ligne de commande. L'une des commandes les plus importantes est la commande `net`, utilis√©e pour l'administration et la maintenance du syst√®me d'exploitation. Cette commande prend en charge de nombreuses sous-commandes qui peuvent √™tre combin√©es avec des commutateurs pour cibler des sorties sp√©cifiques.

##### Points cl√©s :
- **Commande `net`** : Outil principal pour l'administration du r√©seau.
- **Sous-commandes** : La commande `net` supporte plusieurs sous-commandes, chacune ayant une fonction sp√©cifique.
- **Commutateurs** : Utilis√©s pour affiner la sortie des sous-commandes.
  
##### Pour obtenir de l'aide :
- Tapez `net help` pour obtenir une liste des sous-commandes disponibles.
- Pour de l'aide d√©taill√©e sur une sous-commande sp√©cifique, tapez `C:\> net help [nom_de_la_commande]`.

```
net accounts :
D√©finit les exigences de mot de passe et de connexion pour les utilisateurs
```

```
net session : 
R√©pertorie ou d√©connecte les sessions entre un ordinateur et d'autres ordinateurs sur le r√©seau
```

```
net share :
Cr√©e, supprime ou g√®re des ressources partag√©es
```

```
net start :
D√©marre un service r√©seau ou r√©pertorie les services r√©seau en cours d'ex√©cution
```

```
net stop :
Arr√™te un service r√©seau
```

```
net use :
Se connecte, se d√©connecte et affiche des informations sur les ressources r√©seau partag√©es
```

```
net viewn :
Affiche une liste des ordinateurs et des appareils sur le r√©seau
```

#### 7.3.8 Acc√©der aux ressources du r√©seau

Comme d'autres syst√®mes d'exploitation, **Windows** utilise la technologie de r√©seau pour de nombreuses applications, telles que le web, la messagerie √©lectronique et les services de fichiers. Microsoft a particip√© √† la mise en ≈ìuvre du protocole **SMB (Bloc de messages du serveur)**, initialement d√©velopp√© par IBM, pour partager des ressources r√©seau. SMB est surtout utilis√© pour acc√©der √† des fichiers sur des h√¥tes distants.

##### Protocole SMB (Server Message Block)

Utilis√© pour partager des ressources r√©seau, principalement pour acc√©der √† des fichiers sur des h√¥tes distants. Windows utilise SMB, initialement d√©velopp√© par IBM.

##### Format UNC (Universal Naming Convention)

Permet de se connecter aux ressources r√©seau. Exemple : `\\servername\sharename\file`

- **servername** : Le serveur h√©bergeant la ressource, identifi√© par un nom DNS, un nom NetBIOS ou une adresse IP.
- **sharename** : La racine du dossier partag√© sur le syst√®me de fichiers de l'h√¥te distant.
- **file** : La ressource recherch√©e par l'h√¥te local, qui peut se trouver √† un niveau plus profond dans le syst√®me de fichiers.
##### Partages administratifs

Cr√©√©s automatiquement par Windows et identifi√©s par le signe dollar (`$`). Par exemple, chaque volume de disque poss√®de un partage administratif (`C$`, `D$`). Les dossiers administratifs et d'installation de Windows, comme `admin$` et `print$`, sont √©galement partag√©s. Seuls les utilisateurs avec des privil√®ges d'administrateur peuvent y acc√©der.
##### Connexion √† un partage

Saisir le nom UNC du partage dans l'Explorateur de fichiers Windows. Les informations d'identification de l'ordinateur distant doivent √™tre utilis√©es pour acc√©der aux ressources partag√©es.

---
#### Protocole RDP (Remote Desktop Protocol)

Permet de se connecter et de g√©rer un h√¥te distant comme s'il s'agissait d'une machine locale, pour des t√¢ches telles que la configuration, l'installation de logiciels ou la r√©solution de probl√®mes. Utilis√© fr√©quemment par les analystes en s√©curit√© lors d'incidents li√©s √† la s√©curit√©.

#### S√©curit√© du RDP

RDP est une cible pour les acteurs de menace. Il est essentiel de prendre des pr√©cautions lors de son activation, surtout sur les versions h√©rit√©es non corrig√©es de Windows, comme celles utilis√©es dans les syst√®mes de contr√¥le industriels. Limiter l'exposition de RDP √† Internet et adopter des approches de s√©curit√© telles que **Zero Trust** sont recommand√©es.

#### 7.3.9 Serveur Windows

La plupart des installations Windows sont effectu√©es sur des ordinateurs de bureau et des ordinateurs portables. Windows Server, une autre √©dition de Windows, est principalement utilis√© dans les data centers. Cette famille de produits Microsoft commence √† partir de Windows Server¬†2003. Windows Server, qui h√©berge de nombreux services, est utilis√© √† diff√©rentes fins dans une entreprise.

**Note:**¬†Bien qu'il existe un Windows Server 2000, il est consid√©r√© comme une version client de Windows NT 5.0. Bas√© sur NT 5.2, Windows Server 2003 est la premi√®re √©dition d'une nouvelle famille de versions de Windows Server.

Voici quelques-uns des services que Windows Server fournit:

- **Services r√©seau -**¬†DNS, DHCP, services de terminal, contr√¥leur r√©seau et virtualisation du r√©seau Hyper-V
- **Services de fichiers -**¬†SMB, NFS, et DFS
- **Services Web -**¬†FTP, HTTP, et HTTPS
- **Gestion -**¬†Contr√¥le de la politique de groupe et des services de domaine Active Directory